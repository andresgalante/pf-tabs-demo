"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var _createClass=function(){function t(t,e){for(var a=0;a<e.length;a++){var i=e[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,a,i){return a&&t(e.prototype,a),i&&t(e,i),e}}();!function(){function t(t,e){window.ShadowDOMPolyfill&&WebComponents.ShadowCSS.shimStyling(t,e)}var e=(document._currentScript||document.currentScript).ownerDocument,a=e.querySelector(".tabs-template"),i=e.querySelector(".tab-template"),n=e.querySelector(".panel-template"),o=Array.prototype.forEach;t(a.content,"pf-tabs"),t(n.content,"pf-tab");var r=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return _inherits(e,t),_createClass(e,[{key:"attachedCallback",value:function(){this.createShadowRoot(),this.shadowRoot.appendChild(document.importNode(n.content,!0))}},{key:"attributeChangedCallback",value:function(t,e,a){var i=this.parentNode;"title"===t&&i.handleTitle(this,a)}},{key:"title",get:function(){return this._title},set:function(t){this._title!==t&&(this._title=t,this.setAttribute("title",t))}},{key:"active",get:function(){return this._active},set:function(t){this._active!==t&&(this._active=t,this.setAttribute("active",t))}}]),e}(HTMLElement),s=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return _inherits(e,t),_createClass(e,[{key:"createdCallback",value:function(){this.selected=null,this.tabMap=new Map,this.panelMap=new WeakMap,this.displayMap=new WeakMap}},{key:"attachedCallback",value:function(){this.createShadowRoot(),this.shadowRoot.appendChild(document.importNode(a.content,!0)),this.makeTabsFromPfTab(),this.shadowRoot.querySelector("ul").addEventListener("click",this),this.mutationObserver||(this.mutationObserver=new MutationObserver(this.handleMutations.bind(this)),this.mutationObserver.observe(this,{childList:!0}))}},{key:"detachedCallback",value:function(){this.shadowRoot.querySelector("ul").removeEventListener("click",this)}},{key:"handleEvent",value:function(t){"BUTTON"===t.target.tagName&&this.setTabStatus(t.target.parentNode)}},{key:"handleMutations",value:function(t){var e=this,a=[];t.forEach(function(t){o.call(t.addedNodes,function(t){a.push(["add",t])}),o.call(t.removedNodes,function(t){a.push(["remove",t])})}),a.length&&requestAnimationFrame(function(){var t=e.shadowRoot.querySelector("ul");a.forEach(function(a){var i,n=a[0],o=a[1];if("PF-TAB"===o.nodeName)if("add"===n)i=e.makeTab(o),e.tabMap.set(i,o),e.panelMap.set(o,i),o.attributes.active?e.tabMap.forEach(function(t,a){var n=i===a?e.makeActive:e.makeInactive;n.call(e,a)}):e.makeInactive(i),t.appendChild(i);else if(i=e.panelMap.get(o),i.parentNode.removeChild(i),e.panelMap.delete(o),e.tabMap.delete(i),e.displayMap.delete(i),o.attributes.active){var r=t.querySelector("li:last-child");e.setTabStatus(r)}})})}},{key:"handleTitle",value:function(t,e){var a=this.panelMap.get(t);a&&(a.textContent=t.title)}},{key:"makeTabsFromPfTab",value:function(){var t=this.shadowRoot.querySelector("ul"),e=this.querySelectorAll("pf-tab");[].forEach.call(e,function(e,a){var i=this.makeTab(e);t.appendChild(i),this.tabMap.set(i,e),this.panelMap.set(e,i),0===a?this.makeActive(i):e.style.display="none"}.bind(this))}},{key:"makeTab",value:function(t){var e=document.importNode(i.content,!0),a=e.firstElementChild,n=a.firstElementChild;return n.textContent=t.title,this.displayMap.set(t,t.style.display),a}},{key:"makeActive",value:function(t){t.classList.add("active");var e=this.tabMap.get(t),a=this.displayMap.get(e);e.style.display=a,e.setAttribute("active","")}},{key:"makeInactive",value:function(t){t.classList.remove("active");var e=this.tabMap.get(t);e.style.display="none",e.removeAttribute("active")}},{key:"setTabStatus",value:function(t){if(t!==this.selected){this.selected=t;var e=this.shadowRoot.querySelector("ul").children;[].forEach.call(e,function(e){var a=t===e?this.makeActive:this.makeInactive;a.call(this,e)}.bind(this))}}}]),e}(HTMLElement);document.registerElement("pf-tab",r),document.registerElement("pf-tabs",s)}();